[tool:pytest]
# Pytest configuration for Seiketsu AI API testing

# Test discovery
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Test directories
testpaths = tests

# Minimum version requirements
minversion = 7.0

# Default command line options
addopts = 
    --strict-markers
    --strict-config
    --verbose
    --tb=short
    --durations=10
    --cov=app
    --cov-report=term-missing
    --cov-report=html:htmlcov
    --cov-fail-under=80

# Test markers for categorization
markers =
    # Performance and load testing
    performance: Performance benchmark tests
    load: Load testing (may take several minutes)
    ramp: Gradual load ramp testing
    spike: Traffic spike testing
    soak: Sustained load testing (long-running)
    concurrent: Concurrent request testing
    memory_pressure: Memory usage testing
    database_load: Database performance testing
    
    # Voice processing specific
    voice: Voice processing API tests
    voice_load: Voice API load testing
    websocket_scale: WebSocket scaling tests
    
    # Security testing
    security: Security validation tests
    auth: Authentication and authorization tests
    multitenant: Multi-tenant isolation tests
    
    # API contract testing
    contract: API contract validation
    openapi: OpenAPI specification tests
    external: External API integration tests
    
    # Integration testing
    integration: End-to-end integration tests
    workflow: Complete workflow testing
    
    # Compliance testing
    compliance: Regulatory compliance tests
    tcpa: TCPA compliance validation
    gdpr: GDPR compliance validation
    
    # Slow tests (skip by default)
    slow: Tests that take more than 30 seconds
    
    # Environment specific
    unit: Unit tests (fast, no external dependencies)
    integration: Integration tests (require running services)
    e2e: End-to-end tests (full system)

# Async testing configuration
asyncio_mode = auto

# Test timeout (prevent hanging tests)
timeout = 300

# Warnings configuration
filterwarnings =
    ignore::UserWarning
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    error::pytest.PytestUnraisableExceptionWarning

# Log configuration for tests
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Parallel execution configuration
# Uncomment to enable parallel test execution
# -n auto requires pytest-xdist
# addopts = -n auto

# Coverage configuration
[tool:coverage:run]
source = app
omit = 
    */tests/*
    */venv/*
    */env/*
    */__pycache__/*
    */migrations/*
    */alembic/*
    app/main.py

[tool:coverage:report]
precision = 2
show_missing = true
skip_covered = false
exclude_lines =
    pragma: no cover
    def __repr__
    raise AssertionError
    raise NotImplementedError
    if __name__ == .__main__.:
    if TYPE_CHECKING:

[tool:coverage:html]
directory = htmlcov
title = Seiketsu AI API Test Coverage Report